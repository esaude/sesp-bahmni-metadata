<config>
    <globalProperties>
        <globalProperty>
            <property>bahmni.sqlGet.patientPrescriptions</property>
            <value>SELECT DISTINCT o.order_id, d.uuid, d.name, dro.dose, cn3.name AS unit, cn4.name as route, cn5.name as frequency,
cn.name AS line_treatment, cn2.name AS category, dro.dosing_instructions,
erp.dispensed AS 'drug_dispensed', erp.arv_dispensed AS 'arv_dispensed',
erp.first_arv_dispensed AS 'first_arv_dispensed', o.date_created, date(erp.dispensed_date) AS 'dispensed_date'
FROM person p
INNER JOIN encounter enc ON p.person_id = enc.patient_id
INNER JOIN orders o ON enc.encounter_id = o.encounter_id
INNER JOIN drug d ON o.concept_id = d.concept_id
INNER JOIN drug_order_relationship dor ON o.order_id = dor.drug_order_id
INNER JOIN concept_name cn ON dor.treatment_line_id = cn.concept_id
INNER JOIN concept_name cn2 ON d.dosage_form = cn2.concept_id
LEFT JOIN drug_order dro ON dro.order_id = o.order_id
INNER JOIN order_frequency ofreq ON ofreq.order_frequency_id = dro.frequency
INNER JOIN concept_name cn5 ON cn5.concept_id = ofreq.concept_id
INNER JOIN concept_name cn3 ON cn3.concept_id = dro.dose_units
INNER JOIN concept_name cn4 ON cn4.concept_id = dro.route
LEFT JOIN erpdrug_order erp ON dro.order_id = erp.order_id
WHERE cn4.concept_name_type = 'FULLY_SPECIFIED'
AND cn.locale = ${lang_treatmentLine}
AND cn3.locale = ${lang_unit}
AND cn4.locale = ${lang_route}
AND p.uuid = ${patientUuid}
GROUP BY o.order_id;</value>
        </globalProperty>
    </globalProperties>
</config> 
